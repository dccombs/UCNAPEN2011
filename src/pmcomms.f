C
C  ************  Common blocks of the PENMAIN subroutines.
C                DO NOT MODIFY!
C
      LOGICAL LDUMP,LSPEC,LGPOL,LPSF,LEXSRC,LEXBD,LSCONE,LFORCE,
     1        LDILOG,LDELOG,LDOSEM
      CHARACTER*20 PSFI,PFILED,SPCDIO,SPCDEO,SPCFSO,PSFDIO
      CHARACTER*23 DATE23
      CHARACTER*65 TITLE,TITLE2
C
      PARAMETER (PI=3.1415926535897932D0, TWOPI=2.0D0*PI,
     1  RA2DE=180.0D0/PI, DE2RA=PI/180.0D0)
      COMMON/CTITLE/TITLE,TITLE2
      COMMON/CDATE/DATE23
C
C  ****  Main-PENELOPE commons.
C
      PARAMETER (MAXMAT=10)
      COMMON/TRACK/E,X,Y,Z,U,V,W,WGHT,KPAR,IBODY,MAT,ILB(5)
      COMMON/STOKES/SP1,SP2,SP3,IPOL
      COMMON/CSIMPA/EABS(3,MAXMAT),C1(MAXMAT),C2(MAXMAT),WCC(MAXMAT),
     1  WCR(MAXMAT)
      COMMON/RSEED/ISEED1,ISEED2
C  ****  Composition data.
      COMMON/COMPOS/STF(MAXMAT,30),ZT(MAXMAT),AT(MAXMAT),RHO(MAXMAT),
     1  VMOL(MAXMAT),IZ(MAXMAT,30),NELEM(MAXMAT)
C  ****  Geometry.
      PARAMETER (NS=10000,NB=5000,NX=250)
      COMMON/QTREE/NBODY,MATER(NB),KMOTH(NB),KDGHT(NB,NX),
     1    KSURF(NB,NX),KFLAG(NB,NX),KALIAS(NS),NWARN
      COMMON/QKDET/KDET(NB)
      COMMON/QSIMUL/RHOI(MAXMAT),DSMAX(NB),EABSB(3,NB)
C  ****  Interaction forcing parameters.
      COMMON/CFORCE/FORCE(NB,3,8)
      COMMON/CFORCI/LFORCE(NB,3),WLOW(NB,3),WHIG(NB,3)
C
C  ****  Source definition.
C
C  ----  Primary particles.
      COMMON/CSOUR0/CTHL,DCTH,PHIL,DPHI,KPARP,LSCONE,LGPOL,LPSF,JOBEND
      COMMON/CSOUR1/E0,EPMAX,SP10,SP20,SP30
C  ----  Energy spectrum.
      PARAMETER (NSEM=1000)
      COMMON/CSOUR2/ES(NSEM),PTS(NSEM),IAS(NSEM),FS(NSEM),LSPEC
C  ----  Extended source.
      COMMON/CSOUR3/SX0,SY0,SZ0,SSX,SSY,SSZ,IXSBOD(NB),LEXSRC,LEXBD
C  ----  Input phase-space file.
      PARAMETER (NPSFM=100)
      COMMON/CSOUR4/WGMIN,RWGMIN,WGMAX,RLREAD,IPSFI,NPSF,NPSN,NSPLIT,
     1  KODEPS
      COMMON/CSOUR5/PSFI(NPSFM)
C
C  ****  Discrete counters.
C
      COMMON/CNT0/
     1  PRIM(3),PRIM2(3),DPRIM(3),    ! Numbers of IEXIT particles.
     1  SEC(3,3),SEC2(3,3),DSEC(3,3)  ! Generated secondary particles.
C  ----  Deposited energies in various bodies.
      COMMON/CNT1/TDEBO(NB),TDEBO2(NB),DEBO(NB)
C
C  ****  Continuous distributions.
C
C  ----  Energy spectrum of the source.
      COMMON/CNT2/SHIST(NSEM),DSHE,RDSHE,NSEB
C  ----  Energy distributions of emerging particles.
      PARAMETER (NBEM=1000)
      COMMON/CNT3/PDE(3,2,NBEM),PDE2(3,2,NBEM),PDEP(3,2,NBEM),
     1  EMIN,EMAX,BSE,RBSE,LPDE(3,2,NBEM),NBE
C
C  ----  Angular distributions of emerging particles.
      PARAMETER (NBTHM=180,NBPHM=180)
      COMMON/CNT4/PDA(3,NBTHM,NBPHM),PDA2(3,NBTHM,NBPHM),
     1  PDAP(3,NBTHM,NBPHM),BSTH,RBSTH,BSPH,RBSPH,LPDA(3,NBTHM,NBPHM),
     1  NBTH,NBPH
C
C  ----  Impact detectors (up to NIDM different detectors).
      PARAMETER (NIDM=25,NIDCM=1000)
      COMMON/CNT5/PSFDIO(NIDM),SPCDIO(NIDM),RLAST,RWRITE,NDIDEF,
     1  KKDI(NIDM,3),NPSFO,IPSFO,LDILOG(NIDM)
      COMMON/CNT6/DIT(NIDM,NIDCM),DIT2(NIDM,NIDCM),DITP(NIDM,NIDCM),
     1  LDIT(NIDM,NIDCM),TDID(NIDM),TDID2(NIDM),DEDI(NIDM),IPSF(NIDM),
     1  IDCUT(NIDM)
      COMMON/CNT7/DIP(NIDM,NIDCM,3),DIP2(NIDM,NIDCM,3),
     1  DIPP(NIDM,NIDCM,3),LDIP(NIDM,NIDCM,3)
      COMMON/CNT8/EDIL(NIDM),EDIU(NIDM),BDIE(NIDM),RBDIE(NIDM),
     1  NDICH(NIDM)
      COMMON/CNT9/EDILL(NIDM),EDIUL(NIDM),BDIEL(NIDM),RBDIEL(NIDM)
C
C  ----  Energy distributions of fluence.
      COMMON/CNT10/SPCFSO(NIDM)
      COMMON/CNT11/FST(NIDM,NIDCM),FST2(NIDM,NIDCM),FSTP(NIDM,NIDCM),
     1  LFST(NIDM,NIDCM)
      COMMON/CNT12/FSP(NIDM,NIDCM,3),FSP2(NIDM,NIDCM,3),
     1  FSPP(NIDM,NIDCM,3),LFSP(NIDM,NIDCM,3)
C
C  ----  Energy-deposition detectors (up to NEDM different detectors).
      PARAMETER (NEDM=25,NEDCM=1000)
      COMMON/CNT13/SPCDEO(NEDM),LDELOG(NEDM),NDEDEF,KBDE(NB)
      COMMON/CNT14/DET(NEDM,NEDCM),TDED(NEDM),TDED2(NEDM),DEDE(NEDM)
      COMMON/CNT15/EDEL(NEDM),EDEU(NEDM),BDEE(NEDM),RBDEE(NEDM),
     1  NDECH(NEDM)
      COMMON/CNT16/EDELL(NEDM),EDEUL(NEDM),BDEEL(NEDM),RBDEEL(NEDM)
C
C  ----  Dose distribution (up to NDXM*NDYM*NDZM volume bins).
      PARAMETER (NDXM=101,NDYM=101,NDZM=101)
      COMMON/CNT17/DOSE(NDXM,NDYM,NDZM),DOSE2(NDXM,NDYM,NDZM),
     1  DOSEP(NDXM,NDYM,NDZM),LDOSE(NDXM,NDYM,NDZM),LDOSEM
      COMMON/CNT18/DDOSE(NDZM),DDOSE2(NDZM),DDOSEP(NDZM),LDDOSE(NDZM)
      COMMON/CNT19/DXL(3),DXU(3),BDOSE(3),RBDOSE(3),NDB(3)
C
C  ****  Job details.
C
C  ----  Dump file.
      COMMON/CDUMP/PFILED,LDUMP
C  ----  Time control and shower counters.
      COMMON/CNTRL/TSIM,TSEC,TSECA,TSECAD,CPUT0,DUMPP,DSHN,SHN,N
